<?php
session_start();

function verificarSesion() {
    if (!isset($_SESSION['usuario_id'])) {
        redirectTo('login.php');
        exit();
    }
}

function verificarRol($rolesPermitidos) {
    if (!isset($_SESSION['rol']) || !in_array($_SESSION['rol'], $rolesPermitidos)) {
        redirectTo('dashboard.php');
        exit();
    }
}

// Funci칩n para redireccionar con rutas absolutas
function redirectTo($path) {
    $base_path = '/opticap/';
    $absolute_path = $base_path . ltrim($path, '/');
    header("Location: " . $absolute_path);
    exit();
}

// Funci칩n para verificar si el usuario est치 logueado (sin redirecci칩n)
function estaLogueado() {
    return isset($_SESSION['usuario_id']);
}
?>